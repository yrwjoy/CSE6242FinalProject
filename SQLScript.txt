CREATE TABLE REGION (
ID INTEGER PRIMARY KEY ASC,
NAME TEXT,
SIZE_RANK INTEGER
);

CREATE TABLE HOUSE_VALUE_BY_MONTH (
REGION_ID INTEGER,
HOUSETYPE_ID INTEGER,
TIME INTEGER,
VALUE FLOAT,
PRIMARY KEY (REGION_ID, HOUSETYPE_ID, TIME)
);

CREATE TABLE HOUSE_TYPE (
ID INTEGER PRIMARY KEY ASC,
CATEGORY TEXT,
HOUSE_TYPE TEXT
);

SELECT TIME, VALUE
      FROM
     (SELECT ID AS SELECTED_HOUSETYPE_ID
      FROM HOUSE_TYPE
      WHERE CATEGORY = 'bedroom' AND HOUSE_TYPE = 'one') LEFT JOIN  HOUSE_VALUE_BY_MONTH
      ON SELECTED_HOUSETYPE_ID = HOUSETYPE_ID
      WHERE region_id = 48;

